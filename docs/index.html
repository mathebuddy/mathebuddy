<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="img/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="img/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="img/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="manifest.json" />
    <link
      rel="mask-icon"
      href="img/favicon/safari-pinned-tab.svg"
      color="#9c1e14"
    />
    <link rel="shortcut icon" href="img/favicon/favicon.ico" />
    <meta name="msapplication-TileColor" content="#9c1e14" />
    <meta name="msapplication-config" content="img/favicon/browserconfig.xml" />

    <!-- TODO: -->
    <meta
      http-equiv="Content-Security-Policy"
      content="upgrade-insecure-requests"
    />

    <title>mathe:buddy</title>
    <!--<link rel="stylesheet" href="css/normalize.css" />-->
    <link rel="stylesheet" href="css/skeleton.css?v=4" />

    <style>
      pre code {
        white-space: pre-wrap;
      }
      /*TODO: add to skeleton.css*/
      .tooltip {
        position: relative;
        display: inline-block;
        border-bottom: 1px dotted black;
      }
      .tooltip .tooltiptext {
        visibility: hidden;
        width: 120px;
        max-height: 32px;
        background-color: rgb(255, 255, 255);
        color: #000000;
        text-align: center;
        border-radius: 30px;
        border-style: solid;
        border-width: 2px;
        border-color: #000000;
        padding: 0px 0;
        position: absolute;
        z-index: 1;
        top: 85%;
        left: 50%;
        margin-left: -60px;
        opacity: 0.85;
        text-transform: none;
      }
      .tooltip:hover .tooltiptext {
        visibility: visible;
      }
      .milestone-green {
        background-color: #4ba645;
        color: white;
        font-size: large;
        border-radius: 30px;
        padding-top: 10px;
        padding-bottom: 10px;
      }
      .milestone-red {
        background-color: #aa322c;
        color: white;
        font-size: large;
        border-radius: 30px;
        padding-top: 10px;
        padding-bottom: 10px;
      }
      .milestone-green-small-font {
        background-color: #4ba645;
        color: white;
        font-size: medium;
        border-radius: 30px;
        padding-top: 10px;
        padding-bottom: 10px;
      }
      .milestone-red-small-font {
        background-color: #aa322c;
        color: white;
        font-size: medium;
        border-radius: 30px;
        padding-top: 10px;
        padding-bottom: 10px;
      }
      .milestone-done {
        font-size: large;
        padding-top: 10px;
        padding-bottom: 10px;
        text-align: right;
        padding-left: 10px;
      }
      .milestone-todo {
        font-size: large;
        border-left-style: solid;
        border-left-color: #000000;
        border-left-width: 2px;
        padding-top: 10px;
        padding-bottom: 10px;
        text-align: left;
        padding-left: 10px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <br />
      <div style="text-align: left">
        <span onclick="switchLanguage('de')" style="cursor: pointer"
          ><b>German</b></span
        >
        |
        <span onclick="switchLanguage('en')" style="cursor: pointer"
          ><b>English</b></span
        >
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <a
          href="https://github.com/mathebuddy"
          target="_blank"
          style="cursor: pointer"
        >
          <img
            src="img/github/GitHub_Logo.png"
            style="max-height: 26px; vertical-align: middle"
          />
        </a>
        <img
          src="img/app-store/ios.png"
          style="height: 32px; vertical-align: middle"
        />
        <img
          src="img/app-store/android.png"
          style="height: 32px; vertical-align: middle"
        />
        <br />
      </div>

      <span class="text-german">
        <a href="index.html">
          <img class="u-max-full-width" src="img/logo/logo-large.svg" />
        </a>
      </span>
      <span class="text-english">
        <a href="index.html">
          <img class="u-max-full-width" src="img/logo/logo-large-en.svg" />
        </a>
      </span>

      <div class="row">
        <div style="text-align: center">
          <button class="button-primary" onclick="show('home')">home</button>
          <button class="button-primary" onclick="show('blog')">blog</button>
          <button class="button-primary" onclick="show('doc')">doc</button>
          <button class="button-primary" onclick="show('sim-info')">sim</button>
          <button class="button-primary" onclick="show('play-info')">
            play
          </button>
          <button class="button-primary" onclick="show('road')">road</button>
        </div>
        <div id="play-list" style="text-align: center; display: none">
          <b>PLAYGROUNDS</b><br />
          <button class="button" onclick="showPlayground('play-info')">
            INFO
          </button>
          <button class="button" onclick="showPlayground('math-runtime')">
            math
          </button>
          <button class="button" onclick="showPlayground('smpl')">SMPL</button>
          <button class="button" onclick="showPlayground('mbl')">MBL</button>
          <button class="button" onclick="showPlayground('chat')">chat</button>
          <button class="button" onclick="showPlayground('tex')">TeX</button>
        </div>
        <div id="doc-list" style="text-align: center; display: none">
          <b>DOCUMENTATION</b><br />
          <button class="button" onclick="showDoc('mbl')">MBL</button>
          <button class="button" onclick="showDoc('smpl')">SMPL</button>
          <button class="button" onclick="showDoc('mbcl')">MBCL</button>
        </div>
        <div id="sim-list" style="text-align: center; display: none">
          <b>SIMULATION</b><br />
          <button id="showSimInfo" class="button">info</button>
          <button id="showSimDemo" class="button">demo</button>
          <button id="showSimLocalhost" class="button">
            http://localhost:8271
          </button>
          <br />
          <span style="font-size: smaller">
            Info: <code>http://localhost:8271</code> is currently NOT available
            in the Apple Safari browser.
          </span>
        </div>
      </div>
    </div>

    <!-- ===== HOME ===== -->
    <div id="home" class="container" style="display: none">
      <div class="row">
        <div id="home-contents"></div>
      </div>
    </div>

    <!-- ===== BLOG ===== -->
    <div id="blog" class="container" style="display: none">
      <div class="row">
        <br />
        <h2>Blog</h2>
        <div id="blog-items"></div>
      </div>
    </div>

    <!-- ===== ROAD ===== -->
    <div id="road" class="container" style="display: none">
      <div class="row" style="text-align: left">
        <br />
        <h2>Roadmap</h2>

        <p style="font-size: large; color: #434343">
          <em>Note: This page only lists technical stuff.</em>
        </p>
      </div>

      <div class="row" style="text-align: center">
        <div class="one-half column offset-by-three milestone-green">
          Project Start 09/2022
        </div>
      </div>
      <div class="row" style="text-align: center; display: flex">
        <div class="one-half column milestone-done">
          <span style="color: gray; font-size: small">DONE</span><br />
          formal language definition<br />
          simulator prototype<br />
        </div>
        <div class="one-half column milestone-todo">
          <span style="color: gray; font-size: small">WIP / TODO</span><br />
          complete math runtime<br />
          complete compiler<br />
          rewrite code with Dart<br />
          flutter simulator<br />
        </div>
      </div>
      <div class="row" style="text-align: center">
        <div class="one-half column offset-by-three milestone-red">
          Release Webapp ~03/2023
        </div>
      </div>
      <div class="row" style="text-align: center">...</div>
      <div class="row" style="text-align: center">
        <div class="one-half column offset-by-three milestone-red">
          Release iOS / Android App ~09/2023
        </div>
      </div>

      <div class="row">
        <br /><br />
        <div id="upcoming-features"></div>
      </div>
    </div>

    <!-- ===== SIM ===== -->
    <div id="sim-info" class="container" style="display: none">
      <div class="row">
        <br />
        <h2>Simulator</h2>
        <div id="sim-info-contents"></div>
      </div>
    </div>

    <div id="sim" class="container" style="display: none">
      <div class="row">
        <br />
        <h2>Simulator</h2>
        <!--<p id="localhost-error-info" style="font-size: larger; display: none">
          ERROR: You need to run a local webserver on your local computer. Head
          to your course directory and run <code>python3 server.py</code>. Then
          reload this page.
        </p>
        <p id="localhost-error-info" style="font-size: larger; display: none">
          WARNING: The Safari Browser is currently NOT supported.
        </p>-->
        <!--<div style="text-align: center; color: #aa322c">Simulator</div>-->
        <div id="sim-list" class="row" style="padding: 0px; text-align: left">
          <span
            style="
              color: gray;
              width: 20px;
              display: inline-block;
              text-align: center;
            "
          >
            <img
              src="img/fontawesome/mobile-screen-solid.svg"
              style="height: 12px"
            />
          </span>
          <button
            class="button"
            onclick="setDevice('iPhone5s')"
            style="font-size: 10px"
          >
            iPhone 5s
          </button>
          <button
            class="button"
            onclick="setDevice('iPhone8')"
            style="font-size: 10px"
          >
            iPhone 8
          </button>
          <button
            class="button"
            onclick="setDevice('iPhone14ProMax')"
            style="font-size: 10px"
          >
            iPhone 14 Pro Max
          </button>
        </div>

        <div class="row" style="padding: 0px; text-align: left">
          <span
            style="
              color: gray;
              width: 20px;
              display: inline-block;
              text-align: center;
            "
          >
            <img
              src="img/fontawesome/folder-open-solid.svg"
              style="height: 12px"
            />
          </span>
          <span
            id="sim-path-buttons"
            style="text-align: left; padding: 0"
          ></span>
        </div>

        <div class="row" style="text-align: left">
          <div class="six columns" style="text-align: center">&nbsp;</div>
          <div class="six columns" style="text-align: center">
            <div id="sim-current-path" style="text-align: center; padding: 0" ;>
              <span>(no file selected)</span>
            </div>
          </div>
        </div>
        <div class="row" style="text-align: left">
          <div class="six columns" style="text-align: center">
            <iframe
              id="sim-iframe"
              title="mathe:buddy simulator instance"
              src="poweroff.html"
              style="
                border-style: solid;
                border-color: #434343;
                border-width: 1px;
                border-radius: 25px;
                min-height: 640px;
                height: 640px;
                max-height: 640px;
                width: 360px;
                min-width: 360px;
                max-width: 360px;
                border-width: 2px;
                -moz-box-shadow: 0 0 10px #aaa;
                -webkit-box-shadow: 0 0 10px #aaa;
                box-shadow: 0 0 10px #aaa;
              "
            >
            </iframe>
          </div>
          <div class="six columns">
            <div
              style="
                border-style: solid;
                border-color: #434343;
                border-width: 1px;
                border-radius: 0px;
                padding: 10px;
                border-width: 2px;
                width: 100%;
                min-height: 640px;
                height: 640px;
                max-height: 640px;
                -moz-box-shadow: 0 0 10px #aaa;
                -webkit-box-shadow: 0 0 10px #aaa;
                box-shadow: 0 0 10px #aaa;
                overflow-y: scroll;
              "
            >
              <div style="width: 100%; text-align: center">
                <button id="resetSim" type="button">
                  <img
                    src="img/fontawesome/power-off-solid.svg"
                    style="
                      height: 20px;
                      vertical-align: middle;
                      padding-inline: 0px;
                    "
                  />
                </button>
                <button id="simShowMblButton" type="button">MBL</button>
                <button id="simShowMbclButton" type="button">MBCL</button>
              </div>
              <div id="sim-data-area"></div>
            </div>
          </div>
        </div>

        <br />

        <div class="row" style="text-align: left">
          <div class="twelve columns">
            <div
              style="
                border-style: solid;
                border-color: #434343;
                border-width: 1px;
                border-radius: 0px;
                padding: 10px;
                border-width: 2px;
                width: 100%;
                min-height: 128px;
                height: 128px;
                max-height: 128px;
                -moz-box-shadow: 0 0 10px #aaa;
                -webkit-box-shadow: 0 0 10px #aaa;
                box-shadow: 0 0 10px #aaa;
                overflow-y: scroll;
              "
            >
              <div id="sim-log-area">Log Area</div>
            </div>
          </div>
        </div>

        <br />
        Link for mobile phone (only for static courses):<br />
        <img
          class="u-max-full-width"
          src="img/qr-sim.png"
          style="max-width: 256px"
        />
        <br />
      </div>
    </div>

    <!-- ===== DOC ===== -->
    <div id="doc" class="container" style="display: none">
      <div class="row">
        <br />
        <h2>Documentation</h2>
        <p style="font-size: large">
          The following diagram visually shows all components of the app and the
          environment.
        </p>
        <div
          style="
            border-style: solid;
            border-width: 1px;
            border-color: black;
            border-radius: 10px;
            padding: 10px;
            width: 65%;
          "
        >
          <img
            class="u-max-full-width"
            src="img/misc/mathebuddy-comp-diag.png?v=6"
          />
        </div>
        <br />

        <!-- TODO: math-runtime -->

        <h3>Mathe:Buddy Langauge (MBL)</h3>
        <p style="font-size: large">
          Formal language to expressively define online math courses.
          <a href="doc/mbl.html" target="_blank">Documentation</a>
        </p>

        <h3>Simple Math Programming Language (SMPL)</h3>
        <p style="font-size: large">
          Turing-complete programming language with intrinsic mathematical data
          types.
          <a href="doc/smpl.html" target="_blank">Documentation</a>
        </p>

        <h3>Mathe:Buddy Compiled Langauge (MBCL)</h3>
        <p style="font-size: large">
          JSON-based technical language for compiled online math courses.
          <a href="doc/mbcl.html" target="_blank">Documentation</a>
        </p>

        <!--<h3>Simulator Guide</h3>
        <p style="font-size: large">
          Mathe:Buddy simulator installation guide.
          <a href="doc/sim.html" target="_blank">Documentation</a>
        </p>-->
      </div>
    </div>

    <!-- ===== PLAYGROUNDS ===== -->

    <div id="play-info" class="container" style="display: none">
      <div class="row">
        <br />
        <h2>Playgrounds</h2>
        <div id="play-info-contents"></div>
      </div>
    </div>

    <!-- ===== PLAYGROUND: MATH RUNTIME ===== -->

    <div id="math-runtime" class="container" style="display: none">
      <div class="row">
        <h2>Math-Runtime</h2>
        <p>
          "Math Runtime" is used as math engine in the <i>mathe:buddy</i> app.
          It is entirely written in the <i>Dart</i> programming language and has
          no dependencies.
        </p>
        <b>Currently implemented grammar</b>
        <pre><code id="math-runtime-grammar"></code></pre>
      </div>

      <div class="row">
        <h4>Robust Parsing of Student Input</h4>
        <input type="text" id="student-term" class="u-full-width" />
        <button id="runParser" type="button">run</button>
        <br />
      </div>

      <div class="row">
        <b>Tokens:</b>&nbsp;
        <div id="tokens">(empty)</div>
      </div>

      <div class="row" style="padding-top: 5px">
        <b>Parsed Term / Error(s):</b>&nbsp;
        <div id="term">(empty)</div>
      </div>

      <br />

      <div class="row">
        <h4>Numerical Evaluation of Terms</h4>
        <input type="text" id="term-eval" class="u-full-width" />
        <button id="runEval" type="button">run</button>
        <br />
      </div>

      <div class="row">
        <b>Output:</b>&nbsp;
        <div id="eval-output">(empty)</div>
      </div>

      <br />

      <div class="row">
        <h4>Term Optimization</h4>
        <input type="text" id="term-opt" class="u-full-width" />
        <button id="runOpt" type="button">run</button>
        <br />
      </div>

      <div class="row">
        <b>Output:</b>&nbsp;
        <div id="opt-output">(empty)</div>
      </div>

      <br />

      <div class="row">
        <h4>Automatic Differentiation</h4>
        Term:
        <input type="text" id="term-diff" class="u-full-width" />
        Variable:
        <input type="text" id="term-diff-var" class="u-full-width" />
        <button id="runDiff" type="button">run</button>
        <br />
      </div>

      <div class="row">
        <b>Output:</b>&nbsp;
        <div id="diff-output">(empty)</div>
      </div>

      <br />

      <div class="row">
        <h4>Equivalency of Terms</h4>
        First Term:
        <input type="text" id="term-compare-first" class="u-full-width" />
        Second Term:
        <input type="text" id="term-compare-second" class="u-full-width" />
        <button id="runCompare" type="button">run</button>
        <br />
      </div>

      <div class="row">
        <b>Output:</b>&nbsp;
        <div id="compare-output">(empty)</div>
      </div>

      <br />
    </div>

    <!-- ===== PLAYGROUND: SMPL ===== -->

    <div id="smpl" class="container" style="display: none">
      <div class="row">
        <h2>SMPL</h2>
        <p>
          SMPL is a math-oriented programming language that can be interpreted
          in the browser. It is entirely written in the <i>Dart</i> programming
          language and has no dependencies, except "math-runtime".
        </p>
        <p>
          More examples can be found in
          <a href="https://github.com/mathebuddy/mathebuddy-public-courses"
            >https://github.com/mathebuddy/mathebuddy-public-courses</a
          >
          (consider @code parts).
        </p>
        <b>Currently implemented grammar</b>
        (math-runtime grammar is not listed here)
        <pre><code id="smpl-grammar"></code></pre>
      </div>

      <div class="row">
        <h4>Source Code</h4>
        <textarea
          id="smpl-editor"
          class="u-full-width"
          style="width: 100%; min-height: 150px; resize: vertical"
          spellcheck="false"
        ></textarea>
        <button id="runSmpl" type="button">run</button>
        <br />
      </div>

      <br />

      <div class="row">
        <h4>Output</h4>
        <div id="smpl-output">(empty)<br /><br /></div>
      </div>

      <div class="row">
        <h4>Intermediate Code</h4>
        <div id="smpl-ic">(empty)<br /><br /></div>
      </div>
    </div>

    <!-- ===== PLAYGROUND: MBL ===== -->

    <div id="mbl" class="container" style="display: none">
      <div class="row">
        <h2>MBL</h2>
        <p>
          MBL (mathe:buddy language) is a language to describe randomized and
          gamified math online courses. The compiler is entirely written in the
          <i>Dart</i> programming language and has no dependencies, except
          "smpl" and "math-runtime", which are part of the mathe:buddy project.
          The compiler generates code in the MBCL format (mathe:buddy compiled
          language), which is encodes as JSON-data.
        </p>
        <p>
          More examples can be found in
          <a href="https://github.com/mathebuddy/mathebuddy-public-courses"
            >https://github.com/mathebuddy/mathebuddy-public-courses</a
          >
        </p>
        <b>Currently implemented grammar</b>
        <pre><code id="mbl-grammar"></code></pre>
      </div>

      <div class="row">
        <h4>MBL Code</h4>
        <textarea
          id="mbl-editor"
          class="u-full-width"
          style="width: 100%; min-height: 150px; resize: vertical"
          spellcheck="false"
        ></textarea>
        <button id="runMbl" type="button">run</button>
        <br />
      </div>

      <br />

      <div class="row">
        <h4>MBCL</h4>
        <div id="mbl-output">(empty)<br /><br /></div>
      </div>
    </div>

    <!-- ===== PLAYGROUND: CHAT ===== -->

    <div id="chat" class="container" style="display: none">
      <div class="row">
        <h2>CHAT</h2>
        <p>
          The app will contain a chatbot. This playground provides the current
          implementation. The language is yet only German.
        </p>
      </div>

      <div class="row">
        <h4>Playground</h4>
        Examples:
        <ul>
          <li><code>Wie geht's?</code></li>
          <li><code>a=[[1,2],[3,4]]</code></li>
          <li><code>3*a</code></li>
        </ul>
        <button id="chat-reset" type="button">reset</button><br />
      </div>
      <div id="chat-content"></div>
      <div class="row" style="text-align: right">
        <input
          id="chat-input"
          type="text"
          class="u-full-width"
          value=""
          style="width: 75%; text-align: right"
        />
      </div>
      <div class="row" style="text-align: right">
        Press ENTER to post messages.
      </div>
    </div>

    <!-- ===== PLAYGROUND: TEX ===== -->

    <div id="tex" class="container" style="display: none">
      <div class="row">
        <h2>TeX</h2>
        <p>
          <code>TeX</code> syntax is used to display equations in the
          <i>mathe:buddy</i> app. Unfortunately, there is currently no fully
          implemented TeX rendering engine available that meets our demands: We
          use <code>Flutter</code> to write the app. Equations must be embedded
          into TextSpan elements in fluent text. These elements must be
          updatable at runtime. All available libraries, for example
          <code>MathJax</code>, use <code>JavaScript (JS)</code>. Even it is
          feasible to run JS code from Flutter, MathJax has a minified size of
          nearly 2 MB (would still be OK!). Furthermore, we would require
          conditional code for the JS runtime (dart:js for the web-app,
          flutter_js for all other platforms), that results in an ugly build
          process.
        </p>
        <p>
          YES, we know about <code>flutter_tex</code>; but it just is a shell
          around MathJax and does not provide TextSpan integration.
        </p>

        <ul>
          <li>
            <!-- -->
            We will use the
            <a href="https://pub.dev/packages/tex" target="_blank">tex</a>
            package for equation rendering. It is extremely light-weight and
            entirely written in the <code>Dart</code> programming language;
            without any dependencies and maintained by the mathe:buddy software
            architect.
          </li>
          <li>
            <!-- -->This playground uses the above mentioned the tex typesetter.
          </li>
          <li>
            <!-- -->
            A list of implemented glyphs, macros and examples can be found
            <a href="https://andreas-schwenk.github.io/tex/" target="_blank"
              >here</a
            >.
          </li>
          <li>
            <!-- -->
            The changelog can be found
            <a href="https://pub.dev/packages/tex/changelog" target="_blank"
              >here</a
            >.
          </li>
        </ul>
      </div>

      <div class="row">
        <b>Input TeX Code:</b>&nbsp;
        <input type="text" id="tex-input" class="u-full-width" />
        <button id="runTex" type="button">typeset</button>
        <button id="runTexWithBorder" type="button">debug</button>
        <br />
      </div>

      <div class="row" style="padding-top: 5px">
        <b>Parsed Term:</b>&nbsp;
        <div id="tex-term">(empty)</div>
      </div>

      <div class="row" style="padding-top: 5px">
        <b>Rendering:</b>&nbsp;
        <div
          id="tex-rendering"
          style="
            overflow-x: scroll;
            border-style: solid;
            border-radius: 3px;
            border-width: 1px;
          "
        ></div>
      </div>

      <br />
    </div>

    <!-- end of tex -->

    <!-- ===== FOOTER ===== -->

    <div class="container">
      <br />
      <br />
      <p style="color: #767676">
        &copy; 2022-<span id="current-year"></span> Prof. Dr. Heiko Knospe,
        Patricia Maria Graf M.Sc.,
        <a href="https://www.th-koeln.de/personen/andreas.schwenk/"
          >Andreas Schwenk M.Sc.</a
        >, TH Köln.
      </p>

      <a href="https://www.th-koeln.de">
        <img
          src="img/misc/logo-th-koeln.png"
          class=""
          alt="Responsive image"
          style="height: 48px"
      /></a>
      &nbsp; &nbsp;
      <a href="https://stiftung-hochschullehre.de">
        <img
          src="img/misc/logo_stiftung_hochschullehre.png"
          class=""
          alt="Responsive image"
          style="height: 48px"
      /></a>
      &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
      <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">
        <img
          src="img/misc/gpl-v3-logo.svg"
          class=""
          alt="Responsive image"
          style="height: 48px"
        />
      </a>

      <br />
    </div>

    <script>
      var language = "en";

      // set home text
      fetch("text/home.html?ver=" + Date.now())
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("home-contents").innerHTML = data;
          refreshLanguage();
        });
      // set simulator info text
      fetch("text/sim-info.html?ver=" + Date.now())
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("sim-info-contents").innerHTML = data;
          refreshLanguage();
        });
      // set playground info text
      fetch("text/play-info.html?ver=" + Date.now())
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("play-info-contents").innerHTML = data;
          refreshLanguage();
        });
      // set upcoming features info
      fetch("text/upcoming-features.txt?ver=" + Date.now())
        .then((response) => response.text())
        .then((data) => {
          data = data.replace(/\n/g, "<br/>");
          document.getElementById("upcoming-features").innerHTML = data;
          refreshLanguage();
        });

      // switch simulator device (only changes width/height)
      function setDevice(id) {
        let width = 360;
        let height = 640;
        switch (id) {
          case "iPhone5s":
            width = 308;
            height = 480;
            break;
          case "iPhone8":
            // default; no change
            break;
          default:
            console.log("Error: unknown device " + id);
        }
        const div = document.getElementById("sim-iframe");
        div.style.minWidth = width + "px";
        div.style.maxWidth = width + "px";
        div.style.width = width + "px";
        div.style.minHeight = height + "px";
        div.style.maxHeight = height + "px";
        div.style.height = height + "px";
      }

      // div selection
      function show(id) {
        document.getElementById("sim").style.display = "none";
        showPlayground(""); // disable active playground
        let divs = [
          "home",
          "blog",
          "doc",
          "math-runtime",
          "smpl",
          "mbl",
          "road",
          "sim-info",
          "play-info",
        ];
        for (let d of divs)
          document.getElementById(d).style.display = id == d ? "block" : "none";
        document.getElementById("doc-list").style.display =
          id == "doc" ? "block" : "none";
        document.getElementById("sim-list").style.display =
          id == "sim-info" ? "block" : "none";
        document.getElementById("play-list").style.display =
          id == "play-info" ? "block" : "none";
      }
      show("home"); // home is default

      // documentation selection
      function showDoc(id) {
        window.open("doc/" + id + ".html?ver=" + Date.now(), "_blank");
      }

      // playground selection
      function showPlayground(id) {
        let playgrounds = [
          "play-info",
          "math-runtime",
          "smpl",
          "mbl",
          "chat",
          "tex",
        ];
        for (let d of playgrounds) {
          document.getElementById(d).style.display = id == d ? "block" : "none";
        }
      }

      // language
      function refreshLanguage() {
        let de = document.getElementsByClassName("text-german");
        for (element of de)
          element.style.display = language == "de" ? "block" : "none";
        let en = document.getElementsByClassName("text-english");
        for (element of en)
          element.style.display = language == "en" ? "block" : "none";
      }
      function switchLanguage(id) {
        language = id;
        refreshLanguage();
      }

      // update formal grammar (read from "*-grammar")
      let element1 = document.getElementById("math-runtime-grammar");
      fetch("text/math-runtime-grammar.txt?ver=" + Date.now())
        .then((response) => response.text())
        .then((data) => (element1.innerHTML = data));
      let element2 = document.getElementById("smpl-grammar");
      fetch("text/smpl-grammar.txt?ver=" + Date.now())
        .then((response) => response.text())
        .then((data) => (element2.innerHTML = data));
      let element3 = document.getElementById("mbl-grammar");
      fetch("text/mbl-grammar.txt?ver=" + Date.now())
        .then((response) => response.text())
        .then((data) => (element3.innerHTML = data));

      // set current year in footer
      document.getElementById("current-year").innerHTML =
        new Date().getFullYear();

      // load blog
      fetch("blog/list.txt?ver=" + Date.now())
        .then((response) => response.text())
        .then((data) => updateBlogList(data));

      function updateBlogList(data) {
        let lines = data.split("\n");
        let div = document.getElementById("blog-items");
        let idx = 0;
        for (let line of lines) {
          filename = line.trim();
          if (line.length == 0) continue;

          let blogItem = document.createElement("div");
          blogItem.style.borderStyle = "solid";
          blogItem.style.borderRadius = "10px";
          blogItem.style.borderColor = "#aa322c";
          blogItem.style.padding = "10px";
          blogItem.style.fontSize = "large";
          div.appendChild(blogItem);

          div.appendChild(document.createElement("br"));

          let dateAndAuthor = document.createElement("h6");
          dateAndAuthor.id = "blog-date-and-author-" + idx;
          dateAndAuthor.style.marginBottom = "0px";
          dateAndAuthor.innerHTML = "<i>TODO: DATE AND NAME</i>";
          blogItem.appendChild(dateAndAuthor);

          let title = document.createElement("h3");
          title.id = "blog-title-" + idx;
          title.style.color = "#aa322c";
          title.innerHTML = "TODO: TITLE";
          blogItem.appendChild(title);

          let p = document.createElement("p");
          p.id = "blog-text-" + idx;
          p.innerHTML = "TODO: text";
          blogItem.appendChild(p);

          let _idx = idx;
          fetch("blog/" + filename + "?ver=" + Date.now())
            .then((response) => response.text())
            .then((data) => updateBlogItem(_idx, data));

          idx++;
        }

        function updateBlogItem(idx, src) {
          let date = "";
          let title = "";
          let authorName = "";
          let authorUrl = "";
          let imgPath = "";
          let lines = src.split("\n");
          for (let line of lines) {
            if (line.startsWith("<!--date="))
              date = line.substring(9, line.length - 3);
            else if (line.startsWith("<!--title="))
              title = line.substring(10, line.length - 3);
            else if (line.startsWith("<!--author-name="))
              authorName = line.substring(16, line.length - 3);
            else if (line.startsWith("<!--author-url="))
              authorUrl = line.substring(15, line.length - 3);
            else if (line.startsWith("<!--img="))
              imgPath = "blog/img/" + line.substring(8, line.length - 3);
          }
          let author = authorName;
          if (authorUrl.length > 0)
            author =
              '<a href="' + authorUrl + '" target="_blank">' + author + "</a>";
          document.getElementById("blog-date-and-author-" + idx).innerHTML =
            date + " " + author;
          document.getElementById("blog-title-" + idx).innerHTML = title;
          if (imgPath.length > 0) {
            src +=
              '<br/><br/><img class="u-max-full-width" src="' + imgPath + '"/>';
          }
          document.getElementById("blog-text-" + idx).innerHTML = src;
          refreshLanguage();
        }
      }
    </script>

    <script src="js/index.min.js?version=1687877260"></script>
  </body>
</html>
